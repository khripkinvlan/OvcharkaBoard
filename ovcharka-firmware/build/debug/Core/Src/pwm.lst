ARM GAS  C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s 			page 1


   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"pwm.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.file 1 "Core/Src/pwm.c"
  18              		.section	.text.pwm_initDriver,"ax",%progbits
  19              		.align	1
  20              		.global	pwm_initDriver
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	pwm_initDriver:
  26              	.LVL0:
  27              	.LFB65:
   1:Core/Src/pwm.c **** /*
   2:Core/Src/pwm.c ****  * pwm.c
   3:Core/Src/pwm.c ****  *
   4:Core/Src/pwm.c ****  *  Created on: 28/06//2023
   5:Core/Src/pwm.c ****  *      Author: JV4K
   6:Core/Src/pwm.c ****  */
   7:Core/Src/pwm.c **** #include <pwm.h>
   8:Core/Src/pwm.c **** #define constrain(amt,low,high) ((amt)<(low)?(low):((amt)>(high)?(high):(amt)))
   9:Core/Src/pwm.c **** #define ABS(N) ((N<0)?(-N):(N))
  10:Core/Src/pwm.c **** 
  11:Core/Src/pwm.c **** void pwm_initDriver(pwmControl_t *driver, TIM_HandleTypeDef *htim, uint8_t pwmChannel,
  12:Core/Src/pwm.c **** 	GPIO_TypeDef *dir1_Port, uint32_t dir1_Pin) {
  28              		.loc 1 12 46 view -0
  29              		.cfi_startproc
  30              		@ args = 4, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  13:Core/Src/pwm.c **** 	driver->dir1_Port = dir1_Port;
  33              		.loc 1 13 2 view .LVU1
  34              		.loc 1 13 20 is_stmt 0 view .LVU2
  35 0000 C0F80930 		str	r3, [r0, #9]	@ unaligned
  14:Core/Src/pwm.c **** 	driver->dir1_Pin = dir1_Pin;
  36              		.loc 1 14 2 is_stmt 1 view .LVU3
  37              		.loc 1 14 19 is_stmt 0 view .LVU4
  38 0004 009B     		ldr	r3, [sp]
  39              	.LVL1:
  40              		.loc 1 14 19 view .LVU5
  41 0006 C0F80530 		str	r3, [r0, #5]	@ unaligned
  15:Core/Src/pwm.c **** 
  16:Core/Src/pwm.c **** 	driver->htim = htim;
  42              		.loc 1 16 2 is_stmt 1 view .LVU6
ARM GAS  C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s 			page 2


  43              		.loc 1 16 15 is_stmt 0 view .LVU7
  44 000a 0160     		str	r1, [r0]
  17:Core/Src/pwm.c **** 	driver->timerChannel = pwmChannel;
  45              		.loc 1 17 2 is_stmt 1 view .LVU8
  46              		.loc 1 17 23 is_stmt 0 view .LVU9
  47 000c 0271     		strb	r2, [r0, #4]
  18:Core/Src/pwm.c **** }
  48              		.loc 1 18 1 view .LVU10
  49 000e 7047     		bx	lr
  50              		.cfi_endproc
  51              	.LFE65:
  53              		.section	.text.pwm_dutyLimits,"ax",%progbits
  54              		.align	1
  55              		.global	pwm_dutyLimits
  56              		.syntax unified
  57              		.thumb
  58              		.thumb_func
  60              	pwm_dutyLimits:
  61              	.LVL2:
  62              	.LFB66:
  19:Core/Src/pwm.c **** 
  20:Core/Src/pwm.c **** void pwm_dutyLimits(pwmControl_t *driver, uint16_t minDuty, uint16_t maxDuty) {
  63              		.loc 1 20 79 is_stmt 1 view -0
  64              		.cfi_startproc
  65              		@ args = 0, pretend = 0, frame = 0
  66              		@ frame_needed = 0, uses_anonymous_args = 0
  67              		@ link register save eliminated.
  21:Core/Src/pwm.c **** 	driver->minDuty = minDuty;
  68              		.loc 1 21 2 view .LVU12
  69              		.loc 1 21 18 is_stmt 0 view .LVU13
  70 0000 A0F80F10 		strh	r1, [r0, #15]	@ unaligned
  22:Core/Src/pwm.c **** 	driver->maxDuty = maxDuty;
  71              		.loc 1 22 2 is_stmt 1 view .LVU14
  72              		.loc 1 22 18 is_stmt 0 view .LVU15
  73 0004 A0F80D20 		strh	r2, [r0, #13]	@ unaligned
  23:Core/Src/pwm.c **** }
  74              		.loc 1 23 1 view .LVU16
  75 0008 7047     		bx	lr
  76              		.cfi_endproc
  77              	.LFE66:
  79              		.section	.text.pwm_setSpeed,"ax",%progbits
  80              		.align	1
  81              		.global	pwm_setSpeed
  82              		.syntax unified
  83              		.thumb
  84              		.thumb_func
  86              	pwm_setSpeed:
  87              	.LVL3:
  88              	.LFB67:
  24:Core/Src/pwm.c **** 
  25:Core/Src/pwm.c **** void pwm_setSpeed(pwmControl_t *driver, int32_t duty) {
  89              		.loc 1 25 55 is_stmt 1 view -0
  90              		.cfi_startproc
  91              		@ args = 0, pretend = 0, frame = 0
  92              		@ frame_needed = 0, uses_anonymous_args = 0
  93              		.loc 1 25 55 is_stmt 0 view .LVU18
  94 0000 10B5     		push	{r4, lr}
ARM GAS  C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s 			page 3


  95              		.cfi_def_cfa_offset 8
  96              		.cfi_offset 4, -8
  97              		.cfi_offset 14, -4
  98 0002 0446     		mov	r4, r0
  26:Core/Src/pwm.c **** 	if (!duty) {
  99              		.loc 1 26 2 is_stmt 1 view .LVU19
 100              		.loc 1 26 5 is_stmt 0 view .LVU20
 101 0004 69B9     		cbnz	r1, .L4
  27:Core/Src/pwm.c **** 		driver->_duty = 0;
 102              		.loc 1 27 3 is_stmt 1 view .LVU21
 103              		.loc 1 27 17 is_stmt 0 view .LVU22
 104 0006 0023     		movs	r3, #0
 105 0008 4374     		strb	r3, [r0, #17]
 106 000a 8374     		strb	r3, [r0, #18]
 107 000c C374     		strb	r3, [r0, #19]
 108 000e 0375     		strb	r3, [r0, #20]
  28:Core/Src/pwm.c **** 		driver->dir = 0;
 109              		.loc 1 28 3 is_stmt 1 view .LVU23
 110              		.loc 1 28 15 is_stmt 0 view .LVU24
 111 0010 4375     		strb	r3, [r0, #21]
 112              	.LVL4:
 113              	.L5:
  29:Core/Src/pwm.c **** 	} else {
  30:Core/Src/pwm.c **** 		driver->_duty = constrain(ABS(duty), driver->minDuty, driver->maxDuty);
  31:Core/Src/pwm.c **** 		if (duty > 0) {
  32:Core/Src/pwm.c **** 			HAL_GPIO_WritePin(driver->dir1_Port, driver->dir1_Pin, 1);
  33:Core/Src/pwm.c **** 			driver->dir = 1;
  34:Core/Src/pwm.c **** 		} else {
  35:Core/Src/pwm.c **** 			HAL_GPIO_WritePin(driver->dir1_Port, driver->dir1_Pin, 0);
  36:Core/Src/pwm.c **** 			driver->dir = -1;
  37:Core/Src/pwm.c **** 		}
  38:Core/Src/pwm.c **** 	}
  39:Core/Src/pwm.c **** 
  40:Core/Src/pwm.c **** 	switch (driver->timerChannel) {
 114              		.loc 1 40 2 is_stmt 1 view .LVU25
 115              		.loc 1 40 16 is_stmt 0 view .LVU26
 116 0012 2379     		ldrb	r3, [r4, #4]	@ zero_extendqisi2
 117              		.loc 1 40 2 view .LVU27
 118 0014 013B     		subs	r3, r3, #1
 119 0016 032B     		cmp	r3, #3
 120 0018 30D8     		bhi	.L3
 121 001a DFE803F0 		tbb	[pc, r3]
 122              	.L10:
 123 001e 2A       		.byte	(.L13-.L10)/2
 124 001f 30       		.byte	(.L12-.L10)/2
 125 0020 36       		.byte	(.L11-.L10)/2
 126 0021 3C       		.byte	(.L9-.L10)/2
 127              	.LVL5:
 128              		.p2align 1
 129              	.L4:
 130              		.loc 1 40 2 view .LVU28
 131 0022 0A46     		mov	r2, r1
  30:Core/Src/pwm.c **** 		if (duty > 0) {
 132              		.loc 1 30 3 is_stmt 1 view .LVU29
  30:Core/Src/pwm.c **** 		if (duty > 0) {
 133              		.loc 1 30 19 is_stmt 0 view .LVU30
 134 0024 81EAE171 		eor	r1, r1, r1, asr #31
ARM GAS  C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s 			page 4


 135              	.LVL6:
  30:Core/Src/pwm.c **** 		if (duty > 0) {
 136              		.loc 1 30 19 view .LVU31
 137 0028 A1EBE271 		sub	r1, r1, r2, asr #31
 138 002c B0F80F30 		ldrh	r3, [r0, #15]	@ unaligned
 139 0030 9942     		cmp	r1, r3
 140 0032 04DB     		blt	.L6
  30:Core/Src/pwm.c **** 		if (duty > 0) {
 141              		.loc 1 30 19 discriminator 2 view .LVU32
 142 0034 B0F80D30 		ldrh	r3, [r0, #13]	@ unaligned
 143 0038 8B42     		cmp	r3, r1
 144 003a A8BF     		it	ge
 145 003c 0B46     		movge	r3, r1
 146              	.L6:
  30:Core/Src/pwm.c **** 		if (duty > 0) {
 147              		.loc 1 30 17 discriminator 4 view .LVU33
 148 003e C4F81130 		str	r3, [r4, #17]	@ unaligned
  31:Core/Src/pwm.c **** 			HAL_GPIO_WritePin(driver->dir1_Port, driver->dir1_Pin, 1);
 149              		.loc 1 31 3 is_stmt 1 view .LVU34
  31:Core/Src/pwm.c **** 			HAL_GPIO_WritePin(driver->dir1_Port, driver->dir1_Pin, 1);
 150              		.loc 1 31 6 is_stmt 0 view .LVU35
 151 0042 002A     		cmp	r2, #0
 152 0044 0ADD     		ble	.L7
  32:Core/Src/pwm.c **** 			driver->dir = 1;
 153              		.loc 1 32 4 is_stmt 1 view .LVU36
  32:Core/Src/pwm.c **** 			driver->dir = 1;
 154              		.loc 1 32 47 is_stmt 0 view .LVU37
 155 0046 D4F80510 		ldr	r1, [r4, #5]	@ unaligned
  32:Core/Src/pwm.c **** 			driver->dir = 1;
 156              		.loc 1 32 4 view .LVU38
 157 004a 0122     		movs	r2, #1
 158              	.LVL7:
  32:Core/Src/pwm.c **** 			driver->dir = 1;
 159              		.loc 1 32 4 view .LVU39
 160 004c 89B2     		uxth	r1, r1
 161 004e D4F80900 		ldr	r0, [r4, #9]	@ unaligned
 162              	.LVL8:
  32:Core/Src/pwm.c **** 			driver->dir = 1;
 163              		.loc 1 32 4 view .LVU40
 164 0052 FFF7FEFF 		bl	HAL_GPIO_WritePin
 165              	.LVL9:
  33:Core/Src/pwm.c **** 		} else {
 166              		.loc 1 33 4 is_stmt 1 view .LVU41
  33:Core/Src/pwm.c **** 		} else {
 167              		.loc 1 33 16 is_stmt 0 view .LVU42
 168 0056 0123     		movs	r3, #1
 169 0058 6375     		strb	r3, [r4, #21]
 170 005a DAE7     		b	.L5
 171              	.LVL10:
 172              	.L7:
  35:Core/Src/pwm.c **** 			driver->dir = -1;
 173              		.loc 1 35 4 is_stmt 1 view .LVU43
  35:Core/Src/pwm.c **** 			driver->dir = -1;
 174              		.loc 1 35 47 is_stmt 0 view .LVU44
 175 005c D4F80510 		ldr	r1, [r4, #5]	@ unaligned
  35:Core/Src/pwm.c **** 			driver->dir = -1;
 176              		.loc 1 35 4 view .LVU45
ARM GAS  C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s 			page 5


 177 0060 0022     		movs	r2, #0
 178              	.LVL11:
  35:Core/Src/pwm.c **** 			driver->dir = -1;
 179              		.loc 1 35 4 view .LVU46
 180 0062 89B2     		uxth	r1, r1
 181 0064 D4F80900 		ldr	r0, [r4, #9]	@ unaligned
 182              	.LVL12:
  35:Core/Src/pwm.c **** 			driver->dir = -1;
 183              		.loc 1 35 4 view .LVU47
 184 0068 FFF7FEFF 		bl	HAL_GPIO_WritePin
 185              	.LVL13:
  36:Core/Src/pwm.c **** 		}
 186              		.loc 1 36 4 is_stmt 1 view .LVU48
  36:Core/Src/pwm.c **** 		}
 187              		.loc 1 36 16 is_stmt 0 view .LVU49
 188 006c FF23     		movs	r3, #255
 189 006e 6375     		strb	r3, [r4, #21]
 190 0070 CFE7     		b	.L5
 191              	.L13:
  41:Core/Src/pwm.c **** 	case 1:
  42:Core/Src/pwm.c **** 		driver->htim->Instance->CCR1 = driver->_duty;
 192              		.loc 1 42 3 is_stmt 1 view .LVU50
 193              		.loc 1 42 9 is_stmt 0 view .LVU51
 194 0072 2368     		ldr	r3, [r4]
 195              		.loc 1 42 15 view .LVU52
 196 0074 1B68     		ldr	r3, [r3]
 197              		.loc 1 42 40 view .LVU53
 198 0076 D4F81120 		ldr	r2, [r4, #17]	@ unaligned
 199              		.loc 1 42 32 view .LVU54
 200 007a 5A63     		str	r2, [r3, #52]
  43:Core/Src/pwm.c **** 		break;
 201              		.loc 1 43 3 is_stmt 1 view .LVU55
 202              	.L3:
  44:Core/Src/pwm.c **** 	case 2:
  45:Core/Src/pwm.c **** 		driver->htim->Instance->CCR2 = driver->_duty;
  46:Core/Src/pwm.c **** 		break;
  47:Core/Src/pwm.c **** 	case 3:
  48:Core/Src/pwm.c **** 		driver->htim->Instance->CCR3 = driver->_duty;
  49:Core/Src/pwm.c **** 		break;
  50:Core/Src/pwm.c **** 	case 4:
  51:Core/Src/pwm.c **** 		driver->htim->Instance->CCR4 = driver->_duty;
  52:Core/Src/pwm.c **** 		break;
  53:Core/Src/pwm.c **** 	default:
  54:Core/Src/pwm.c **** 		break;
  55:Core/Src/pwm.c **** 	}
  56:Core/Src/pwm.c **** }
 203              		.loc 1 56 1 is_stmt 0 view .LVU56
 204 007c 10BD     		pop	{r4, pc}
 205              	.LVL14:
 206              	.L12:
  45:Core/Src/pwm.c **** 		break;
 207              		.loc 1 45 3 is_stmt 1 view .LVU57
  45:Core/Src/pwm.c **** 		break;
 208              		.loc 1 45 9 is_stmt 0 view .LVU58
 209 007e 2368     		ldr	r3, [r4]
  45:Core/Src/pwm.c **** 		break;
 210              		.loc 1 45 15 view .LVU59
ARM GAS  C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s 			page 6


 211 0080 1B68     		ldr	r3, [r3]
  45:Core/Src/pwm.c **** 		break;
 212              		.loc 1 45 40 view .LVU60
 213 0082 D4F81120 		ldr	r2, [r4, #17]	@ unaligned
  45:Core/Src/pwm.c **** 		break;
 214              		.loc 1 45 32 view .LVU61
 215 0086 9A63     		str	r2, [r3, #56]
  46:Core/Src/pwm.c **** 	case 3:
 216              		.loc 1 46 3 is_stmt 1 view .LVU62
 217 0088 F8E7     		b	.L3
 218              	.L11:
  48:Core/Src/pwm.c **** 		break;
 219              		.loc 1 48 3 view .LVU63
  48:Core/Src/pwm.c **** 		break;
 220              		.loc 1 48 9 is_stmt 0 view .LVU64
 221 008a 2368     		ldr	r3, [r4]
  48:Core/Src/pwm.c **** 		break;
 222              		.loc 1 48 15 view .LVU65
 223 008c 1B68     		ldr	r3, [r3]
  48:Core/Src/pwm.c **** 		break;
 224              		.loc 1 48 40 view .LVU66
 225 008e D4F81120 		ldr	r2, [r4, #17]	@ unaligned
  48:Core/Src/pwm.c **** 		break;
 226              		.loc 1 48 32 view .LVU67
 227 0092 DA63     		str	r2, [r3, #60]
  49:Core/Src/pwm.c **** 	case 4:
 228              		.loc 1 49 3 is_stmt 1 view .LVU68
 229 0094 F2E7     		b	.L3
 230              	.L9:
  51:Core/Src/pwm.c **** 		break;
 231              		.loc 1 51 3 view .LVU69
  51:Core/Src/pwm.c **** 		break;
 232              		.loc 1 51 9 is_stmt 0 view .LVU70
 233 0096 2368     		ldr	r3, [r4]
  51:Core/Src/pwm.c **** 		break;
 234              		.loc 1 51 15 view .LVU71
 235 0098 1B68     		ldr	r3, [r3]
  51:Core/Src/pwm.c **** 		break;
 236              		.loc 1 51 40 view .LVU72
 237 009a D4F81120 		ldr	r2, [r4, #17]	@ unaligned
  51:Core/Src/pwm.c **** 		break;
 238              		.loc 1 51 32 view .LVU73
 239 009e 1A64     		str	r2, [r3, #64]
  52:Core/Src/pwm.c **** 	default:
 240              		.loc 1 52 3 is_stmt 1 view .LVU74
 241              		.loc 1 56 1 is_stmt 0 view .LVU75
 242 00a0 ECE7     		b	.L3
 243              		.cfi_endproc
 244              	.LFE67:
 246              		.text
 247              	.Letext0:
 248              		.file 2 "C:/Users/zhmis/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-to
 249              		.file 3 "C:/Users/zhmis/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-to
 250              		.file 4 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/stm32f103xb.h"
 251              		.file 5 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_def.h"
 252              		.file 6 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_gpio.h"
 253              		.file 7 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_dma.h"
ARM GAS  C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s 			page 7


 254              		.file 8 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_tim.h"
 255              		.file 9 "Core/Inc/pwm.h"
ARM GAS  C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s 			page 8


DEFINED SYMBOLS
                            *ABS*:00000000 pwm.c
C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s:19     .text.pwm_initDriver:00000000 $t
C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s:25     .text.pwm_initDriver:00000000 pwm_initDriver
C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s:54     .text.pwm_dutyLimits:00000000 $t
C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s:60     .text.pwm_dutyLimits:00000000 pwm_dutyLimits
C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s:80     .text.pwm_setSpeed:00000000 $t
C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s:86     .text.pwm_setSpeed:00000000 pwm_setSpeed
C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s:123    .text.pwm_setSpeed:0000001e $d
C:\Users\zhmis\AppData\Local\Temp\ccpbNVZe.s:128    .text.pwm_setSpeed:00000022 $t

UNDEFINED SYMBOLS
HAL_GPIO_WritePin
